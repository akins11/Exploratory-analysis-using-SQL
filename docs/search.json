[
  {
    "objectID": "location.html",
    "href": "location.html",
    "title": "5. Geo-location Summary",
    "section": "",
    "text": "A temporary table containing sales, cost and profit.\n\nCREATE TEMPORARY TABLE revenue_tbl\n      SELECT store_id,\n             year(order_date) AS order_year,\n             (order_quantity * unit_price) AS sales,\n             ((order_quantity * unit_cost) + ((order_quantity * unit_price) * discount_applied)) AS cost,\n             (order_quantity * unit_price) - ((order_quantity * unit_cost) + ((order_quantity * unit_price) * discount_applied)) AS profit\n        FROM sales_order;\n\n\n\n\n\n\nTotal sales, cost and profit By :-\n\nRegionStateCountyCity\n\n\n\nSELECT r.region, \n       round(SUM(rt.sales), 2) AS Total_Sales,\n       round(SUM(rt.cost), 2) AS Total_Cost,\n       round(SUM(rt.profit), 2) AS Total_Profit\n  FROM revenue_tbl rt\n  JOIN store s\n    ON rt.store_id = s.store_id\n  JOIN regions r\n    ON s.state_code = r.state_code\n  GROUP BY r.region\n  ORDER BY Total_Profit DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      Region\n      Total Sales\n      Total Cost\n      Total Profit\n    \n  \n  \n    West\n\n29,117,275.37\n21,600,037.62\n7,517,237.75\n    South\n\n26,424,203.68\n19,580,128.45\n6,844,075.24\n    Midwest\n\n17,524,761.22\n12,988,219.29\n4,536,541.93\n    Northeast\n\n9,626,486.30\n7,199,014.32\n2,427,471.98\n  \n  \n  \n\n\n\n\nThe highest profit was made in th west region, followed by the South and Midwest, while the Northeast Region was where the lowest profit was made.\n\n\n\nSELECT s.state, \n       round(SUM(rt.sales), 2) AS Total_Sales,\n       round(SUM(rt.cost), 2) AS Total_Cost,\n       round(SUM(rt.profit), 2) AS Total_Profit\n  FROM revenue_tbl rt\n  JOIN store s\n    ON rt.store_id = s.store_id\n  GROUP BY s.state\n  ORDER BY Total_Profit DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      State\n      Total Sales\n      Total Cost\n      Total Profit\n    \n  \n  \n    California\n17,283,447.28\n12,928,105.62\n4,355,341.67\n    Texas\n8,339,041.10\n6,214,597.69\n2,124,443.41\n    Illinois\n6,543,441.12\n4,852,767.21\n1,690,673.91\n    Florida\n6,087,613.29\n4,467,219.39\n1,620,393.90\n    New York\n4,034,987.91\n3,014,268.87\n1,020,719.03\n    Colorado\n3,265,050.70\n2,361,928.60\n903,122.10\n    Indiana\n3,087,467.20\n2,260,215.96\n827,251.24\n    North Carolina\n2,227,415.00\n1,629,237.20\n598,177.80\n    Washington\n1,899,570.60\n1,389,664.16\n509,906.44\n    Virginia\n1,862,358.80\n1,361,738.42\n500,620.38\n    Arizona\n1,831,532.10\n1,386,010.81\n445,521.28\n    Nevada\n1,696,326.10\n1,256,277.04\n440,049.06\n    Connecticut\n1,800,826.00\n1,366,710.39\n434,115.61\n    New Jersey\n1,589,139.50\n1,178,288.20\n410,851.30\n    Tennessee\n1,418,698.21\n1,024,309.17\n394,389.04\n    Michigan\n1,537,261.40\n1,144,435.21\n392,826.19\n    Ohio\n1,254,635.30\n893,007.19\n361,628.11\n    Oregon\n1,242,133.09\n884,683.95\n357,449.14\n    Georgia\n1,333,132.50\n999,907.70\n333,224.79\n    Oklahoma\n1,165,210.39\n870,279.55\n294,930.84\n    Massachusetts\n1,155,461.90\n869,672.80\n285,789.10\n    Kansas\n1,063,236.40\n810,644.23\n252,592.17\n    Louisiana\n1,084,649.60\n843,648.93\n241,000.67\n    Missouri\n858,946.70\n645,514.12\n213,432.59\n    Utah\n819,510.50\n606,563.63\n212,946.87\n    Alabama\n745,636.30\n540,553.96\n205,082.34\n    Iowa\n800,060.40\n595,459.25\n204,601.14\n    Wisconsin\n660,419.00\n469,419.46\n190,999.55\n    Pennsylvania\n626,068.10\n442,641.33\n183,426.77\n    South Carolina\n724,966.80\n558,298.68\n166,668.13\n    Minnesota\n747,123.70\n580,931.64\n166,192.05\n    New Mexico\n521,507.90\n364,111.97\n157,395.93\n    Maryland\n572,454.70\n441,439.75\n131,014.95\n    Nebraska\n393,450.80\n282,571.83\n110,878.97\n    Kentucky\n382,067.50\n273,166.37\n108,901.13\n    North Dakota\n424,713.00\n339,483.78\n85,229.22\n    District of Columbia\n188,149.40\n124,393.88\n63,755.52\n    Montana\n190,320.20\n137,820.98\n52,499.22\n    New Hampshire\n224,704.60\n172,854.74\n51,849.86\n    Idaho\n209,629.60\n160,966.16\n48,663.44\n    Rhode Island\n195,298.30\n154,577.98\n40,720.32\n    South Dakota\n154,006.20\n113,769.42\n40,236.78\n    Hawaii\n158,247.30\n123,904.71\n34,342.59\n    Mississippi\n178,179.80\n144,369.59\n33,810.21\n    Arkansas\n114,630.30\n86,968.18\n27,662.12\n  \n  \n  \n\n\n\n\n\n\n\nSELECT s.county, \n       round(SUM(rt.sales), 2) AS Total_Sales,\n       round(SUM(rt.cost), 2) AS Total_Cost,\n       round(SUM(rt.profit), 2) AS Total_Profit\n  FROM revenue_tbl rt\n  JOIN store s\n    ON rt.store_id = s.store_id\n  GROUP BY s.county\n  ORDER BY Total_Profit DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      County\n      Total Sales\n      Total Cost\n      Total Profit\n    \n  \n  \n    Los Angeles County\n3,705,528.80\n2,874,450.23\n831,078.57\n    Orange County\n2,291,601.00\n1,710,272.73\n581,328.27\n    San Diego County\n2,217,438.70\n1,646,807.24\n570,631.46\n    Cook County\n2,114,332.41\n1,570,701.44\n543,630.97\n    Clark County\n1,737,048.70\n1,259,648.31\n477,400.39\n    Broward County\n1,690,858.90\n1,230,316.72\n460,542.18\n    Marion County\n1,435,073.00\n1,041,745.02\n393,327.99\n    Maricopa County\n1,574,285.60\n1,184,173.48\n390,112.12\n    Riverside County\n1,361,165.30\n996,199.05\n364,966.25\n    DuPage County\n1,430,523.70\n1,078,788.34\n351,735.36\n    San Bernardino County\n1,243,238.59\n943,799.02\n299,439.57\n    Suffolk County\n1,103,838.40\n817,496.28\n286,342.12\n    Middlesex County\n1,047,122.90\n772,038.96\n275,083.94\n    Miami-Dade County\n815,872.40\n578,906.03\n236,966.37\n    King County\n849,258.50\n625,324.67\n223,933.83\n    Contra Costa County\n828,247.30\n608,453.40\n219,793.90\n    Alameda County\n832,280.70\n615,394.40\n216,886.30\n    Ventura County\n929,082.30\n713,324.82\n215,757.48\n    Fairfield County\n813,346.50\n625,950.28\n187,396.22\n    Montgomery County\n605,150.70\n433,672.14\n171,478.56\n    Salt Lake County\n646,643.80\n479,462.45\n167,181.35\n    Jefferson County\n596,568.00\n429,564.50\n167,003.49\n    Solano County\n531,423.90\n365,084.04\n166,339.86\n    Lee County\n522,553.10\n358,369.80\n164,183.30\n    El Paso County\n629,659.30\n466,862.03\n162,797.27\n    New Haven County\n651,420.90\n490,126.17\n161,294.72\n    Jefferson County/Adams County\n534,445.60\n383,538.62\n150,906.98\n    Douglas County\n476,872.50\n326,917.69\n149,954.81\n    Kane County\n473,797.20\n330,287.96\n143,509.25\n    Wagoner County/Tulsa County\n490,654.40\n349,631.73\n141,022.67\n    Pinellas County\n614,061.70\n473,579.02\n140,482.68\n    Macomb County\n551,135.30\n412,093.58\n139,041.71\n    Nassau County\n526,821.00\n389,201.90\n137,619.11\n    Erie County\n560,836.91\n427,711.42\n133,125.49\n    Santa Clara County\n552,522.20\n424,582.18\n127,940.02\n    Hamilton County\n394,536.20\n266,941.64\n127,594.56\n    Sacramento County\n487,840.40\n360,658.05\n127,182.35\n    Sangamon County\n431,084.70\n307,719.91\n123,364.79\n    Lake County\n381,491.30\n260,659.55\n120,831.75\n    Peoria County\n519,705.61\n399,689.94\n120,015.66\n    San Mateo County\n500,731.20\n383,800.69\n116,930.51\n    Will County/DuPage County\n389,658.60\n273,109.59\n116,549.01\n    Hillsborough County\n463,137.50\n346,789.62\n116,347.88\n    Chatham County/Wake County\n364,995.90\n255,597.26\n109,398.64\n    Johnson County\n492,470.10\n383,330.35\n109,139.75\n    Pueblo County\n380,117.80\n272,334.80\n107,783.00\n    Fresno County\n310,833.10\n208,058.08\n102,775.02\n    Palm Beach County\n366,952.29\n265,950.91\n101,001.39\n    Collin County/Denton County\n469,938.00\n370,383.87\n99,554.13\n    Lane County\n327,268.20\n227,878.86\n99,389.34\n    Vanderburgh County\n342,175.70\n242,841.53\n99,334.16\n    Linn County\n348,768.50\n249,816.20\n98,952.30\n    Richmond County\n345,746.80\n249,101.41\n96,645.39\n    Allen County\n432,290.70\n337,357.36\n94,933.33\n    Forsyth County\n338,758.70\n247,865.90\n90,892.80\n    Queens County\n322,725.60\n232,418.18\n90,307.42\n    Alachua County\n324,112.50\n235,357.30\n88,755.20\n    Spokane County\n326,022.00\n237,317.52\n88,704.48\n    Wayne County\n338,035.10\n249,589.34\n88,445.76\n    Richmond city\n308,193.30\n219,919.66\n88,273.64\n    Essex County\n322,028.80\n234,104.67\n87,924.13\n    San Joaquin County\n278,411.80\n191,610.72\n86,801.08\n    Knox County\n387,735.70\n300,990.60\n86,745.10\n    Mecklenburg County\n322,946.70\n236,273.99\n86,672.70\n    Dane County\n254,499.50\n167,950.31\n86,549.19\n    Washtenaw County\n334,591.30\n248,200.80\n86,390.50\n    Hartford County\n336,058.60\n250,633.94\n85,424.67\n    Cass County\n424,713.00\n339,483.78\n85,229.22\n    Arlington County\n353,029.70\n270,629.42\n82,400.28\n    Martin County/Midland County\n348,400.00\n266,004.44\n82,395.56\n    Bexar County/Comal County/Medina County\n307,074.40\n225,634.02\n81,440.38\n    Denver County\n327,750.60\n246,324.86\n81,425.74\n    Lafayette Parish\n301,747.90\n221,124.25\n80,623.65\n    Clackamas County/Multnomah County/Washington County\n273,989.80\n194,832.72\n79,157.08\n    DoÃƒÂ±a Ana County\n259,196.20\n180,272.61\n78,923.59\n    Bernalillo County\n262,311.70\n183,839.36\n78,472.34\n    Shelby County/Jefferson County\n273,520.80\n195,209.09\n78,311.71\n    Webb County\n320,286.80\n242,045.07\n78,241.73\n    Summit County\n209,053.40\n134,084.65\n74,968.74\n    Santa Barbara County\n257,032.10\n182,140.77\n74,891.33\n    Passaic County\n305,386.00\n230,980.36\n74,405.64\n    Kaufman County/Dallas County\n243,752.70\n169,535.26\n74,217.44\n    Collin County/Denton County/Dallas County\n268,924.60\n195,126.41\n73,798.19\n    Berkeley County/Charleston County\n325,599.90\n252,143.55\n73,456.35\n    Hampden County\n256,094.10\n182,760.46\n73,333.64\n    Cuyahoga County\n254,050.60\n180,733.04\n73,317.56\n    Monroe County\n341,545.90\n268,784.80\n72,761.09\n    Howard County\n295,905.50\n225,033.74\n70,871.76\n    Lubbock County\n393,129.20\n322,383.33\n70,745.87\n    Tom Green County\n189,167.80\n118,446.99\n70,720.81\n    Aransas County/Kleberg County/Nueces County/San Patricio County\n191,030.40\n121,247.45\n69,782.94\n    McLennan County\n224,785.00\n155,061.25\n69,723.75\n    Warren County/Polk County\n233,937.20\n165,357.17\n68,580.03\n    St. Joseph County\n298,344.30\n229,938.34\n68,405.96\n    Durham County/Orange County/Wake County\n252,543.10\n184,394.12\n68,148.98\n    Davidson County\n224,202.10\n156,243.13\n67,958.97\n    Tarrant County/Ellis County/Dallas County\n232,503.40\n164,840.03\n67,663.37\n    Weld County\n218,453.50\n150,842.06\n67,611.44\n    Milwaukee County/Washington County/Waukesha County\n272,582.80\n205,268.91\n67,313.90\n    Fort Bend County/Harris County/Brazoria County\n251,685.50\n184,684.29\n67,001.20\n    Philadelphia County\n266,378.60\n199,563.79\n66,814.81\n    Adams County/Douglas County/Arapahoe County\n231,860.20\n165,752.64\n66,107.56\n    Sonoma County\n202,165.80\n136,167.85\n65,997.95\n    Chesapeake city\n184,544.80\n118,818.87\n65,725.93\n    Hernando County\n242,935.30\n177,369.80\n65,565.50\n    Newport News city\n204,926.20\n139,826.59\n65,099.61\n    Christian County/Greene County\n224,852.00\n160,315.05\n64,536.95\n    Cumberland County\n237,092.90\n173,088.67\n64,004.23\n    Canadian County/Pottawatomie County/Oklahoma County/Cleveland County\n253,193.00\n189,286.86\n63,906.14\n    District of Columbia\n188,149.40\n124,393.88\n63,755.52\n    Denton County/Dallas County\n269,139.00\n205,485.48\n63,653.52\n    Midland County/Ector County\n291,965.90\n228,595.89\n63,370.00\n    Marion County/Polk County\n286,029.70\n223,119.65\n62,910.05\n    Denton County\n202,299.80\n140,032.55\n62,267.25\n    Adams County/Weld County\n218,359.70\n156,149.76\n62,209.93\n    Harris County/Montgomery County\n226,084.80\n163,942.94\n62,141.86\n    Guilford County\n229,166.80\n167,407.37\n61,759.43\n    Placer County\n197,944.80\n136,803.55\n61,141.25\n    Washington County\n185,154.50\n124,116.09\n61,038.40\n    Rockwall County/Collin County/Dallas County\n178,394.20\n117,431.44\n60,962.76\n    Olmsted County\n286,485.30\n225,907.18\n60,578.12\n    Brevard County\n247,665.50\n187,187.35\n60,478.15\n    Boulder County\n190,226.40\n129,924.32\n60,302.08\n    Baltimore city\n276,549.20\n216,406.01\n60,143.18\n    Wichita County\n290,150.20\n230,299.74\n59,850.46\n    Polk County\n253,032.20\n193,423.44\n59,608.76\n    Shawnee County\n248,998.80\n190,041.68\n58,957.12\n    Lehigh County\n181,663.80\n123,228.14\n58,435.66\n    Allegheny County\n178,025.70\n119,849.40\n58,176.30\n    Bibb County\n274,184.10\n216,904.16\n57,279.94\n    Hudson County\n249,193.10\n192,758.10\n56,435.00\n    Hampton city\n196,343.50\n139,917.88\n56,425.63\n    Alexandria city\n235,230.30\n178,834.12\n56,396.18\n    Kendall County/Kane County/Will County/DuPage County\n222,433.30\n166,270.95\n56,162.35\n    Davidson County/Randolph County/Forsyth County/Guilford County\n208,644.70\n153,036.68\n55,608.02\n    Pierce County\n224,376.30\n169,123.51\n55,252.79\n    Smith County\n228,423.10\n173,384.88\n55,038.22\n    Multnomah County\n169,690.90\n114,736.63\n54,954.27\n    Washoe County\n239,980.60\n185,136.58\n54,844.02\n    Hennepin County\n239,297.20\n184,547.41\n54,749.79\n    Virginia Beach city\n233,950.60\n179,704.55\n54,246.04\n    Collin County/Dallas County\n181,710.70\n127,669.14\n54,041.56\n    Williamson County/Travis County\n149,865.60\n96,002.09\n53,863.51\n    Bronx County\n230,975.80\n177,172.79\n53,803.01\n    Jones County/Taylor County\n164,572.10\n111,221.24\n53,350.86\n    San Francisco County\n202,896.10\n149,632.04\n53,264.06\n    Limestone County/Madison County\n207,840.70\n155,263.72\n52,576.98\n    Yellowstone County\n190,320.20\n137,820.98\n52,499.22\n    Cleveland County\n214,621.10\n163,183.06\n51,438.04\n    Lexington County/Richland County\n202,715.20\n151,431.09\n51,284.11\n    Cook County/DuPage County\n184,799.40\n133,565.54\n51,233.86\n    Cook County/Kane County\n211,746.80\n160,646.17\n51,100.63\n    Ramsey County\n221,341.20\n170,477.04\n50,864.15\n    Clarke County\n197,408.80\n146,559.65\n50,849.15\n    Delaware County/Franklin County/Fairfield County\n189,288.40\n138,572.68\n50,715.72\n    Marion County.\n198,092.20\n147,674.16\n50,418.04\n    Rockwall County/Kaufman County/Collin County/Denton County/Dallas County\n213,328.00\n162,954.96\n50,373.05\n    Snohomish County\n219,210.60\n169,390.61\n49,819.99\n    Lancaster County\n191,492.70\n141,746.98\n49,745.72\n    Orleans Parish\n212,363.20\n162,727.22\n49,635.98\n    Lucas County\n233,454.80\n184,767.37\n48,687.43\n    Ada County\n209,629.60\n160,966.16\n48,663.44\n    Rutherford County\n160,438.20\n111,855.40\n48,582.80\n    Union County\n187,995.30\n139,822.67\n48,172.63\n    Onondaga County\n156,431.60\n108,436.82\n47,994.78\n    Kendall County/Will County\n203,720.20\n155,980.72\n47,739.48\n    Fayette County\n159,051.30\n111,599.59\n47,451.71\n    St. Louis city\n175,660.60\n128,639.70\n47,020.90\n    Fulton County\n169,483.20\n123,384.92\n46,098.28\n    Chatham County\n163,727.90\n117,651.10\n46,076.80\n    Kings County\n186,755.80\n140,697.29\n46,058.51\n    Kent County\n188,430.80\n142,595.33\n45,835.47\n    Utah County\n172,866.70\n127,101.18\n45,765.52\n    Muscogee County\n171,359.20\n126,028.88\n45,330.32\n    St. Lucie County\n191,285.00\n146,161.04\n45,123.96\n    Randall County/Potter County\n286,880.60\n241,767.36\n45,113.24\n    Stanislaus County\n190,769.10\n146,098.83\n44,670.27\n    New York County\n133,041.90\n88,936.34\n44,105.56\n    Winnebago County/Ogle County\n183,526.40\n139,534.80\n43,991.60\n    Wyandotte County\n176,457.90\n132,601.21\n43,856.69\n    Hidalgo County\n151,379.80\n108,090.26\n43,289.54\n    Cass County/Platte County/Jackson County/Clay County\n181,616.90\n138,911.27\n42,705.63\n    Tulare County\n219,967.70\n177,893.31\n42,074.39\n    Dorchester County/Berkeley County/Charleston County\n196,651.70\n154,724.04\n41,927.66\n    Brazos County\n130,911.30\n89,070.47\n41,840.83\n    New Hanover County\n176,511.50\n134,797.23\n41,714.27\n    Winnebago County\n178,112.80\n136,471.83\n41,640.97\n    Tarrant County\n209,810.50\n168,392.91\n41,417.59\n    Bell County\n209,689.90\n168,272.88\n41,417.02\n    Shelby County\n170,287.20\n128,874.53\n41,412.67\n    Arapahoe County\n127,688.60\n86,646.38\n41,042.22\n    Duval County\n138,288.00\n97,288.72\n40,999.28\n    Providence County\n195,298.30\n154,577.98\n40,720.32\n    Sedgwick County\n145,309.60\n104,670.98\n40,638.61\n    Minnehaha County/Lincoln County\n154,006.20\n113,769.42\n40,236.78\n    Hays County/Williamson County/Travis County\n146,086.80\n106,223.98\n39,862.82\n    Jefferson Parish\n232,637.40\n193,021.31\n39,616.09\n    Westchester County\n148,190.60\n108,579.09\n39,611.50\n    East Baton Rouge Parish\n203,177.50\n163,598.93\n39,578.57\n    Pima County\n180,477.90\n141,320.02\n39,157.88\n    Larimer County\n181,985.40\n143,106.14\n38,879.26\n    Mobile County\n109,411.00\n70,662.32\n38,748.68\n    Rogers County/Wagoner County/Osage County/Tulsa County\n206,741.90\n168,177.91\n38,563.99\n    DeKalb County/Fulton County\n166,133.20\n127,989.46\n38,143.74\n    Brown County\n133,336.70\n96,200.24\n37,136.46\n    Scott County\n217,354.70\n180,285.88\n37,068.82\n    Cameron County\n159,707.90\n122,726.35\n36,981.55\n    Fort Bend County/Harris County/Montgomery County\n218,212.30\n181,980.44\n36,231.86\n    Richmond County/Queens County/Kings County/New York County/Bronx County\n118,087.50\n82,143.14\n35,944.36\n    Rockland County\n277,420.20\n241,512.52\n35,907.68\n    Harris County\n151,098.40\n115,329.34\n35,769.05\n    Leon County\n126,569.70\n91,962.22\n34,607.48\n    Honolulu County\n158,247.30\n123,904.71\n34,342.59\n    Rankin County/Hinds County/Madison County\n178,179.80\n144,369.59\n33,810.21\n    Clinton County/Ingham County/Eaton County\n125,068.90\n91,956.16\n33,112.74\n    Collin County\n119,769.20\n87,694.02\n32,075.18\n    Norfolk city\n146,140.40\n114,087.33\n32,053.07\n    Dallas County\n165,255.50\n133,452.01\n31,803.49\n    Caddo Parish/Bossier Parish\n134,723.60\n103,177.22\n31,546.38\n    Worcester County\n150,187.20\n118,962.22\n31,224.98\n    Jackson County/Clay County\n117,377.30\n87,033.30\n30,344.00\n    Boone County\n159,439.90\n130,614.79\n28,825.11\n    Pulaski County\n114,630.30\n86,968.18\n27,662.12\n    Kern County\n159,875.40\n135,366.67\n24,508.73\n    Parker County/Johnson County/Tarrant County/Wise County/Denton County\n129,665.10\n105,541.32\n24,123.79\n    Durham County/Wake County\n96,754.70\n76,775.97\n19,978.73\n    Monterey County\n97,444.80\n78,920.10\n18,524.70\n    Maricopa County/Yavapai County\n76,768.60\n60,517.32\n16,251.29\n  \n  \n  \n\n\n\n\n\n\n\nSELECT s.city_name AS City, \n       round(SUM(rt.sales), 2) AS Total_Sales,\n       round(SUM(rt.cost), 2) AS Total_Cost,\n       round(SUM(rt.profit), 2) AS Total_Profit\n  FROM revenue_tbl rt\n  JOIN store s\n    ON rt.store_id = s.store_id\n  GROUP BY s.city_name\n  ORDER BY Total_Cost DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      City\n      Total Sales\n      Total Cost\n      Total Profit\n    \n  \n  \n    Columbia\n658,060.60\n507,079.62\n150,980.98\n    Rochester\n628,031.20\n494,691.99\n133,339.21\n    Springfield\n660,017.00\n484,520.62\n175,496.38\n    Arlington\n562,840.20\n439,022.32\n123,817.87\n    Warren\n528,147.60\n416,131.71\n112,015.89\n    Richmond\n571,744.50\n408,270.43\n163,474.07\n    Wayne\n502,654.10\n367,150.25\n135,503.85\n    Broken Arrow\n490,654.40\n349,631.73\n141,022.67\n    Fargo\n424,713.00\n339,483.78\n85,229.22\n    Aurora\n454,293.50\n332,023.59\n122,269.91\n    Costa Mesa\n443,841.50\n328,654.36\n115,187.13\n    Lubbock\n393,129.20\n322,383.33\n70,745.87\n    Pasadena\n408,525.80\n314,907.54\n93,618.26\n    Knoxville\n387,735.70\n300,990.60\n86,745.10\n    Escondido\n389,605.00\n289,039.54\n100,565.46\n    West Jordan\n387,802.70\n281,454.64\n106,348.06\n    Colorado Springs\n348,527.30\n275,553.51\n72,973.78\n    El Cajon\n362,483.40\n275,332.92\n87,150.48\n    Naperville\n389,658.60\n273,109.59\n116,549.01\n    Pueblo\n380,117.80\n272,334.80\n107,783.00\n    Kansas City\n358,074.80\n271,512.48\n86,562.32\n    St. Petersburg\n345,271.10\n268,650.30\n76,620.79\n    Carlsbad\n350,617.70\n266,104.17\n84,513.53\n    Midland\n348,400.00\n266,004.44\n82,395.56\n    West Palm Beach\n366,952.29\n265,950.91\n101,001.39\n    Columbus\n360,647.60\n264,601.56\n96,046.04\n    Torrance\n336,587.90\n263,138.68\n73,449.22\n    Glendale\n357,431.60\n261,650.14\n95,781.45\n    Vista\n336,514.20\n260,549.37\n75,964.83\n    Peoria\n343,951.20\n260,397.11\n83,554.09\n    Washington\n368,560.30\n258,411.23\n110,149.07\n    Los Angeles\n315,261.80\n258,132.14\n57,129.66\n    Orlando\n314,993.80\n257,412.16\n57,581.64\n    Cary\n364,995.90\n255,597.26\n109,398.64\n    Charleston\n325,599.90\n252,143.55\n73,456.35\n    Center\n354,510.40\n251,244.27\n103,266.13\n    Cedar Rapids\n348,768.50\n249,816.20\n98,952.30\n    Detroit\n338,035.10\n249,589.34\n88,445.76\n    Ann Arbor\n334,591.30\n248,200.80\n86,390.50\n    Winston-Salem\n338,758.70\n247,865.90\n90,892.80\n    Bloomingdale (Township)\n312,695.70\n247,043.00\n65,652.69\n    Denver\n327,750.60\n246,324.86\n81,425.74\n    Santa Clarita\n307,724.30\n245,372.76\n62,351.54\n    Evansville\n342,175.70\n242,841.53\n99,334.16\n    Laredo\n320,286.80\n242,045.07\n78,241.73\n    Amarillo\n286,880.60\n241,767.36\n45,113.24\n    Ramapo\n277,420.20\n241,512.52\n35,907.68\n    Scottsdale\n282,867.30\n238,654.44\n44,212.86\n    Temecula\n315,067.50\n237,341.97\n77,725.53\n    Spokane\n326,022.00\n237,317.52\n88,704.48\n    Charlotte\n322,946.70\n236,273.99\n86,672.70\n    Gainesville\n324,112.50\n235,357.30\n88,755.20\n    Newark\n322,028.80\n234,104.67\n87,924.13\n    Stamford (Town)\n278,713.30\n233,375.67\n45,337.63\n    Vallejo\n351,783.50\n233,029.52\n118,753.98\n    Queens\n322,725.60\n232,418.18\n90,307.42\n    Antioch\n318,631.90\n231,562.25\n87,069.65\n    Paterson\n305,386.00\n230,980.36\n74,405.64\n    Wichita Falls\n290,150.20\n230,299.74\n59,850.46\n    South Bend\n298,344.30\n229,938.34\n68,405.96\n    Odessa\n291,965.90\n228,595.89\n63,370.00\n    Eugene\n327,268.20\n227,878.86\n99,389.34\n    San Antonio\n307,074.40\n225,634.02\n81,440.38\n    Lehigh Acres\n324,105.80\n223,858.73\n100,247.08\n    Salem\n286,029.70\n223,119.65\n62,910.05\n    Amherst\n288,173.70\n223,009.00\n65,164.70\n    Lancaster\n238,948.80\n221,363.01\n17,585.79\n    Lafayette\n301,747.90\n221,124.25\n80,623.65\n    Simi Valley\n267,738.70\n220,686.78\n47,051.92\n    Sacramento\n292,582.30\n220,214.29\n72,368.01\n    Miramar\n293,473.40\n219,759.70\n73,713.70\n    Woodbridge (Township)\n311,710.80\n218,924.08\n92,786.73\n    Hollywood\n359,347.80\n218,800.93\n140,546.87\n    Palmdale\n276,649.70\n217,616.34\n59,033.36\n    Macon\n274,184.10\n216,904.16\n57,279.94\n    Frisco\n275,316.40\n216,753.95\n58,562.46\n    Baltimore\n276,549.20\n216,406.01\n60,143.18\n    Clarksville\n308,441.20\n213,937.97\n94,503.23\n    Victorville\n263,122.40\n210,994.66\n52,127.74\n    Chula Vista\n281,433.50\n210,226.67\n71,206.83\n    Sunrise Manor\n284,482.00\n209,909.16\n74,572.84\n    Pompano Beach\n268,562.80\n209,821.96\n58,740.84\n    San Mateo\n279,396.70\n208,766.41\n70,630.29\n    Olathe\n273,721.80\n208,509.93\n65,211.87\n    Fremont\n271,470.60\n207,820.23\n63,650.37\n    Sunnyvale\n269,688.40\n207,720.70\n61,967.70\n    Pembroke Pines\n252,737.40\n206,972.21\n45,765.18\n    Pomona\n262,184.40\n206,869.97\n55,314.43\n    Lewisville\n269,139.00\n205,485.48\n63,653.52\n    Milwaukee\n272,582.80\n205,268.91\n67,313.90\n    Clearwater\n268,790.60\n204,928.71\n63,861.89\n    Buffalo\n272,663.20\n204,702.42\n67,960.78\n    Oceanside\n272,522.50\n201,354.93\n71,167.57\n    Downey\n272,743.60\n200,538.94\n72,204.66\n    Peoria City\n252,523.00\n199,810.15\n52,712.86\n    Philadelphia\n266,378.60\n199,563.79\n66,814.81\n    Cambridge\n283,564.10\n199,236.63\n84,327.47\n    Westminster\n289,922.40\n197,386.42\n92,535.98\n    Phoenix\n270,164.10\n197,142.04\n73,022.06\n    Birmingham\n273,520.80\n195,209.09\n78,311.71\n    Carrollton\n268,924.60\n195,126.41\n73,798.19\n    Henderson\n275,122.10\n194,884.98\n80,237.12\n    Portland\n273,989.80\n194,832.72\n79,157.08\n    Miami Gardens\n273,018.30\n194,203.52\n78,814.78\n    Lakeland\n253,032.20\n193,423.44\n59,608.76\n    Metairie\n232,637.40\n193,021.31\n39,616.09\n    Miami\n264,087.20\n192,764.63\n71,322.57\n    Jersey City\n249,193.10\n192,758.10\n56,435.00\n    Lowell\n239,022.50\n192,179.92\n46,842.58\n    Fort Lauderdale\n269,145.70\n192,020.29\n77,125.41\n    Milton\n238,164.90\n191,980.33\n46,184.58\n    Hialeah\n278,766.90\n191,937.88\n86,829.02\n    Stockton\n278,411.80\n191,610.72\n86,801.08\n    El Paso\n281,132.00\n191,308.52\n89,823.48\n    Lawrence (Township)\n266,861.00\n190,991.61\n75,869.39\n    Huntington Beach\n268,402.00\n190,565.76\n77,836.24\n    Topeka\n248,998.80\n190,041.68\n58,957.12\n    Kent\n248,549.90\n189,347.13\n59,202.77\n    Oklahoma City\n253,193.00\n189,286.86\n63,906.14\n    Concord\n246,064.20\n188,540.38\n57,523.82\n    Vancouver\n280,703.20\n188,507.85\n92,195.35\n    Riverside\n274,988.10\n187,298.00\n87,690.10\n    Palm Bay\n247,665.50\n187,187.35\n60,478.15\n    Thousand Oaks\n249,380.70\n186,501.17\n62,879.53\n    Arvada\n244,523.20\n186,152.20\n58,371.00\n    Highlands Ranch\n274,914.40\n186,092.84\n88,821.56\n    Reno\n239,980.60\n185,136.58\n54,844.02\n    Aurora (Township)\n257,032.10\n184,769.79\n72,262.31\n    Toledo\n233,454.80\n184,767.37\n48,687.43\n    Pearland\n251,685.50\n184,684.29\n67,001.20\n    Minneapolis\n239,297.20\n184,547.41\n54,749.79\n    Durham\n252,543.10\n184,394.12\n68,148.98\n    Albuquerque\n262,311.70\n183,839.36\n78,472.34\n    Bridgeport\n242,660.60\n183,424.16\n59,236.44\n    Santa Maria\n257,032.10\n182,140.77\n74,891.33\n    Houston\n218,212.30\n181,980.44\n36,231.86\n    Lisle (Township)\n233,280.60\n181,883.86\n51,396.74\n    Hayward\n255,698.80\n181,685.41\n74,013.39\n    Cleveland\n254,050.60\n180,733.04\n73,317.56\n    Schaumburg (Township)\n221,569.00\n180,498.24\n41,070.77\n    Spring Valley\n252,094.20\n180,426.78\n71,667.42\n    Davenport\n217,354.70\n180,285.88\n37,068.82\n    Las Cruces\n259,196.20\n180,272.61\n78,923.59\n    Murrieta\n243,632.10\n179,850.31\n63,781.79\n    Virginia Beach\n233,950.60\n179,704.55\n54,246.04\n    Alexandria\n235,230.30\n178,834.12\n56,396.18\n    Naperville (Township)\n243,411.00\n178,538.08\n64,872.92\n    Renton\n240,784.60\n178,171.36\n62,613.24\n    Visalia\n219,967.70\n177,893.31\n42,074.39\n    Spring Hill\n242,935.30\n177,369.80\n65,565.50\n    The Bronx\n230,975.80\n177,172.79\n53,803.01\n    Boston\n226,594.00\n176,533.58\n50,060.42\n    Las Vegas\n242,372.50\n176,253.78\n66,118.71\n    Niles (Township)\n221,883.90\n176,065.28\n45,818.62\n    San Buenaventura (Ventura)\n233,629.00\n175,863.07\n57,765.92\n    Daly City\n221,334.50\n175,034.28\n46,300.22\n    Overland Park\n218,748.30\n174,820.42\n43,927.88\n    Oyster Bay\n227,170.20\n174,617.44\n52,552.76\n    Brookhaven\n241,863.30\n174,205.13\n67,658.17\n    Ontario\n226,768.20\n173,839.10\n52,929.09\n    Tyler\n228,423.10\n173,384.88\n55,038.22\n    Fayetteville\n237,092.90\n173,088.67\n64,004.23\n    Jurupa Valley\n241,896.80\n172,887.57\n69,009.23\n    Manchester\n224,704.60\n172,854.74\n51,849.86\n    Tempe\n227,538.70\n170,782.60\n56,756.10\n    St. Paul\n221,341.20\n170,477.04\n50,864.15\n    Irvine\n208,329.80\n169,748.29\n38,581.51\n    Mesquite\n243,752.70\n169,535.26\n74,217.44\n    Everett\n219,210.60\n169,390.61\n49,819.99\n    Tacoma\n224,376.30\n169,123.51\n55,252.79\n    El Monte\n239,913.60\n168,880.54\n71,033.06\n    Killeen\n209,689.90\n168,272.88\n41,417.02\n    Tulsa\n206,741.90\n168,177.91\n38,563.99\n    Madison\n254,499.50\n167,950.31\n86,549.19\n    Orange\n232,382.80\n167,436.28\n64,946.52\n    Greensboro\n229,166.80\n167,407.37\n61,759.43\n    Anaheim\n215,063.30\n166,318.72\n48,744.58\n    Capital\n252,013.80\n166,274.81\n85,739.00\n    Lakewood\n230,721.20\n165,662.66\n65,058.54\n    East Los Angeles\n221,964.30\n165,637.13\n56,327.17\n    Des Moines\n233,937.20\n165,357.17\n68,580.03\n    Fontana\n225,709.60\n164,905.39\n60,804.21\n    Grand Prairie\n232,503.40\n164,840.03\n67,663.37\n    The Woodlands\n226,084.80\n163,942.94\n62,141.86\n    Berkeley\n222,962.60\n163,647.87\n59,314.73\n    Baton Rouge\n203,177.50\n163,598.93\n39,578.57\n    Norman\n214,621.10\n163,183.06\n51,438.04\n    Dallas\n213,328.00\n162,954.96\n50,373.05\n    New Orleans\n212,363.20\n162,727.22\n49,635.98\n    Edison\n212,825.50\n161,698.34\n51,127.16\n    Louisville\n223,016.20\n161,566.78\n61,449.42\n    Boise City\n209,629.60\n160,966.16\n48,663.44\n    Palatine (Township)\n215,927.60\n160,773.23\n55,154.37\n    Elgin\n211,746.80\n160,646.17\n51,100.63\n    Burbank\n191,090.70\n159,085.34\n32,005.36\n    Bridgeport (Town)\n216,343.00\n159,034.65\n57,308.35\n    Proviso\n205,321.50\n157,476.40\n47,845.10\n    Corona\n198,454.00\n157,377.71\n41,076.29\n    Wheeling (Township)\n211,894.20\n156,597.86\n55,296.34\n    Nashville\n224,202.10\n156,243.13\n67,958.97\n    Thornton\n218,359.70\n156,149.76\n62,209.93\n    Joliet\n203,720.20\n155,980.72\n47,739.48\n    New Haven\n221,301.00\n155,725.82\n65,575.18\n    Huntsville\n207,840.70\n155,263.72\n52,576.98\n    Sterling Heights\n232,711.10\n155,136.26\n77,574.84\n    Waco\n224,785.00\n155,061.25\n69,723.75\n    North Charleston\n196,651.70\n154,724.04\n41,927.66\n    Providence\n195,298.30\n154,577.98\n40,720.32\n    Cincinnati\n226,942.40\n154,534.09\n72,408.30\n    Plano\n194,621.60\n153,629.93\n40,991.67\n    High Point\n208,644.70\n153,036.68\n55,608.02\n    Waterbury\n194,246.40\n151,485.93\n42,760.47\n    Greeley\n218,453.50\n150,842.06\n67,611.44\n    Fullerton\n217,401.60\n149,996.32\n67,405.28\n    York\n225,501.90\n149,978.63\n75,523.27\n    Bremen\n210,514.00\n149,772.64\n60,741.36\n    Islip\n187,807.70\n149,667.88\n38,139.82\n    San Francisco\n202,896.10\n149,632.04\n53,264.06\n    Long Beach\n212,979.60\n149,588.39\n63,391.21\n    San Bernardino\n179,426.00\n148,898.02\n30,527.98\n    Indianapolis\n198,092.20\n147,674.16\n50,418.04\n    Athens\n197,408.80\n146,559.65\n50,849.15\n    Port St. Lucie\n191,285.00\n146,161.04\n45,123.96\n    Rancho Cucamonga\n195,827.60\n146,110.32\n49,717.28\n    Modesto\n190,769.10\n146,098.83\n44,670.27\n    Elgin (Township)\n216,765.10\n145,518.17\n71,246.93\n    Jackson\n178,179.80\n144,369.59\n33,810.21\n    San Diego\n224,262.40\n144,199.64\n80,062.76\n    Fort Collins\n181,985.40\n143,106.14\n38,879.26\n    Grand Rapids\n188,430.80\n142,595.33\n45,835.47\n    Santa Ana\n210,500.60\n141,890.99\n68,609.61\n    Lincoln\n191,492.70\n141,746.98\n49,745.72\n    Augusta\n190,836.10\n141,389.53\n49,446.57\n    Tucson\n180,477.90\n141,320.02\n39,157.88\n    Omaha\n201,958.10\n140,824.85\n61,133.25\n    Fort Wayne\n166,327.50\n140,779.40\n25,548.10\n    Brooklyn\n186,755.80\n140,697.29\n46,058.51\n    Elk Grove\n195,258.10\n140,443.76\n54,814.34\n    Denton\n202,299.80\n140,032.55\n62,267.25\n    Hampton\n196,343.50\n139,917.88\n56,425.63\n    Newport News\n204,926.20\n139,826.59\n65,099.61\n    Elizabeth\n187,995.30\n139,822.67\n48,172.63\n    Rockford\n183,526.40\n139,534.80\n43,991.60\n    Hartford (Town)\n182,327.10\n138,394.63\n43,932.47\n    Garden Grove\n180,685.60\n138,249.84\n42,435.76\n    Billings\n190,320.20\n137,820.98\n52,499.22\n    Seattle\n175,050.90\n136,873.30\n38,177.60\n    Roseville\n197,944.80\n136,803.55\n61,141.25\n    Rockford (Township)\n178,112.80\n136,471.83\n41,640.97\n    Santa Rosa\n202,165.80\n136,167.85\n65,997.95\n    Perry\n186,876.40\n135,745.12\n51,131.28\n    Bakersfield\n159,875.40\n135,366.67\n24,508.73\n    Wilmington\n176,511.50\n134,797.23\n41,714.27\n    Cape Coral\n198,447.30\n134,511.08\n63,936.22\n    Gilbert\n189,998.60\n134,327.63\n55,670.97\n    Akron\n209,053.40\n134,084.65\n74,968.74\n    Santa Clara\n170,340.80\n134,071.66\n36,269.14\n    Chicago\n184,799.40\n133,565.54\n51,233.86\n    Irving\n165,255.50\n133,452.01\n31,803.49\n    Coral Springs\n178,508.10\n133,413.32\n45,094.79\n    Lyons (Township)\n200,115.60\n132,937.92\n67,177.69\n    Fairfield\n179,640.40\n132,054.52\n47,585.88\n    Chandler\n175,600.30\n131,894.56\n43,705.74\n    Calumet\n188,377.20\n130,954.48\n57,422.72\n    Oxnard\n178,333.90\n130,273.80\n48,060.11\n    Maine\n168,786.40\n130,092.29\n38,694.11\n    Hanover\n175,808.00\n130,018.83\n45,789.17\n    Boulder\n190,226.40\n129,924.32\n60,302.08\n    North\n193,114.10\n129,705.07\n63,409.03\n    Downers Grove (Township)\n177,469.60\n129,364.44\n48,105.16\n    Memphis\n170,287.20\n128,874.53\n41,412.67\n    St. Louis\n175,660.60\n128,639.70\n47,020.90\n    Atlanta\n166,133.20\n127,989.46\n38,143.74\n    Richardson\n181,710.70\n127,669.14\n54,041.56\n    Provo\n172,866.70\n127,101.18\n45,765.52\n    Hillsboro\n185,154.50\n124,116.09\n61,038.40\n    Honolulu\n158,247.30\n123,904.71\n34,342.59\n    Salt Lake City\n153,677.90\n123,504.75\n30,173.15\n    Sandy Springs\n169,483.20\n123,384.92\n46,098.28\n    Allentown\n181,663.80\n123,228.14\n58,435.66\n    Brownsville\n159,707.90\n122,726.35\n36,981.55\n    Corpus Christi\n191,030.40\n121,247.45\n69,782.94\n    Bellevue\n184,873.10\n120,932.89\n63,940.21\n    Pittsburgh\n178,025.70\n119,849.40\n58,176.30\n    Montgomery\n154,863.80\n119,418.82\n35,444.98\n    Worcester\n150,187.20\n118,962.22\n31,224.98\n    Chesapeake\n184,544.80\n118,818.87\n65,725.93\n    San Angelo\n189,167.80\n118,446.99\n70,720.81\n    Savannah\n163,727.90\n117,651.10\n46,076.80\n    Garland\n178,394.20\n117,431.44\n60,962.76\n    Waterbury (Town)\n152,358.00\n117,228.49\n35,129.51\n    North Las Vegas\n157,791.70\n116,881.23\n40,910.47\n    Gresham\n169,690.90\n114,736.63\n54,954.27\n    Mesa\n156,203.80\n114,335.50\n41,868.30\n    Babylon (Town)\n167,942.20\n114,164.52\n53,777.68\n    Norfolk\n146,140.40\n114,087.33\n32,053.07\n    Sioux Falls\n154,006.20\n113,769.42\n40,236.78\n    Chattanooga\n167,593.80\n112,407.54\n55,186.26\n    Hartford\n153,731.50\n112,239.31\n41,492.20\n    Huntington\n149,121.90\n112,071.27\n37,050.63\n    Murfreesboro\n160,438.20\n111,855.40\n48,582.80\n    Lexington-Fayette\n159,051.30\n111,599.59\n47,451.71\n    Abilene\n164,572.10\n111,221.24\n53,350.86\n    Enterprise\n153,041.40\n111,170.15\n41,871.25\n    Thornton (Township)\n167,969.00\n109,576.56\n58,392.44\n    Fresno\n161,161.80\n109,308.16\n51,853.64\n    Hempstead (Town)\n161,047.90\n108,929.67\n52,118.23\n    Yonkers\n148,190.60\n108,579.09\n39,611.50\n    Syracuse\n156,431.60\n108,436.82\n47,994.78\n    McAllen\n151,379.80\n108,090.26\n43,289.54\n    Staten Island\n154,910.70\n107,711.88\n47,198.82\n    Austin\n146,086.80\n106,223.98\n39,862.82\n    North Hempstead\n138,602.90\n105,654.78\n32,948.12\n    Fort Worth\n129,665.10\n105,541.32\n24,123.79\n    Wichita\n145,309.60\n104,670.98\n40,638.61\n    Shreveport\n134,723.60\n103,177.22\n31,546.38\n    Norwalk\n135,842.50\n102,655.22\n33,187.28\n    Beaumont\n142,830.60\n102,335.06\n40,495.54\n    Brandon\n135,172.50\n101,457.53\n33,714.97\n    Dayton\n141,845.70\n100,315.35\n41,530.35\n    Rialto\n152,384.80\n99,051.53\n53,333.27\n    Clovis\n149,671.30\n98,749.93\n50,921.37\n    Jacksonville\n138,288.00\n97,288.72\n40,999.28\n    Green Bay\n133,336.70\n96,200.24\n37,136.46\n    Round Rock\n149,865.60\n96,002.09\n53,863.51\n    Tallahassee\n126,569.70\n91,962.22\n34,607.48\n    Lansing\n125,068.90\n91,956.16\n33,112.74\n    Smithtown\n130,509.30\n90,853.91\n39,655.39\n    West Covina\n126,308.40\n90,600.15\n35,708.25\n    Inglewood\n122,643.50\n89,582.15\n33,061.35\n    College Station\n130,911.30\n89,070.47\n41,840.83\n    Manhattan\n133,041.90\n88,936.34\n44,105.56\n    McKinney\n119,769.20\n87,694.02\n32,075.18\n    Independence\n117,377.30\n87,033.30\n30,344.00\n    Little Rock\n114,630.30\n86,968.18\n27,662.12\n    Worth (Township)\n114,543.20\n86,892.20\n27,651.00\n    Centennial\n127,688.60\n86,646.38\n41,042.22\n    San Jose\n112,493.00\n82,789.82\n29,703.18\n    New York City\n118,087.50\n82,143.14\n35,944.36\n    Paradise\n91,441.60\n81,614.38\n9,827.23\n    Salinas\n97,444.80\n78,920.10\n18,524.70\n    Raleigh\n96,754.70\n76,775.97\n19,978.73\n    West Valley City\n105,163.20\n74,503.06\n30,660.14\n    Tampa\n103,260.40\n72,477.35\n30,783.05\n    Surprise\n101,739.50\n71,197.85\n30,541.65\n    Mobile\n109,411.00\n70,662.32\n38,748.68\n    New Haven (Town)\n83,515.50\n65,685.93\n17,829.57\n    Oakland\n82,148.70\n62,240.89\n19,907.81\n    Moreno Valley\n87,126.80\n61,443.49\n25,683.31\n    Stamford\n75,629.60\n50,115.80\n25,513.80\n    Davie\n69,083.70\n49,528.31\n19,555.39\n  \n  \n  \n\n\n\n\n\n\n\n\n\nTop 5 locations with the highest profit:\n\noverall2020\n\n\n\nSELECT r.region, s.state, s.county, s.city_name,\n       round(SUM(rt.sales), 2) AS Total_Sales,\n       round(SUM(rt.cost), 2) AS Total_Cost,\n       round(SUM(rt.profit), 2) AS Total_Profit\n  FROM revenue_tbl rt\n  JOIN store s\n    ON rt.store_id = s.store_id\n  JOIN regions r\n    ON s.state_code = r.state_code\n  GROUP BY r.region, s.state, s.county, s.city_name\n  ORDER BY Total_Profit DESC\n  LIMIT 5;\n\n\n\n\n\n\n\n  \n  \n    \n      Location\n      Total Sales\n      Total Cost\n      Total Profit\n    \n  \n  \n    South\n Region, Oklahoma State, Wagoner County/Tulsa CountyBroken Arrow\n490,654.40\n349,631.73\n141,022.67\n    South\n Region, Florida State, Broward CountyHollywood\n359,347.80\n218,800.93\n140,546.87\n    West\n Region, California State, Solano CountyVallejo\n351,783.50\n233,029.52\n118,753.98\n    Midwest\n Region, Illinois State, Will County/DuPage CountyNaperville\n389,658.60\n273,109.59\n116,549.01\n    West\n Region, California State, Orange CountyCosta Mesa\n443,841.50\n328,654.36\n115,187.13\n  \n  \n  \n\n\n\n\n\n\n\nSELECT r.region, s.state, s.county, s.city_name,\n       round(SUM(rt.sales), 2) AS Total_Sales,\n       round(SUM(rt.cost), 2) AS Total_Cost,\n       round(SUM(rt.profit), 2) AS Total_Profit\n  FROM revenue_tbl rt\n  JOIN store s\n    ON rt.store_id = s.store_id\n  JOIN regions r\n    ON s.state_code = r.state_code\n  WHERE order_year = 2020\n  GROUP BY r.region, s.state, s.county, s.city_name\n  ORDER BY Total_Profit DESC\n  LIMIT 5;\n\n\n\n\n\n\n\n  \n  \n    \n      Location\n      Total Sales\n      Total Cost\n      Total Profit\n    \n  \n  \n    West\n Region, California State, Solano CountyVallejo\n199,579.60\n127,302.68\n72,276.92\n    South\n Region, Florida State, Broward CountyHollywood\n165,878.60\n100,464.09\n65,414.51\n    Northeast\n Region, Massachusetts State, Middlesex CountyCambridge\n207,097.00\n142,282.94\n64,814.06\n    West\n Region, California State, Riverside CountyRiverside\n191,104.10\n127,071.66\n64,032.43\n    West\n Region, California State, Orange CountyCosta Mesa\n228,302.50\n165,363.81\n62,938.69\n  \n  \n  \n\n\n\n\n\n\n\n\nInsight\n\n\nIn 2020 The store at Vallejo in Solano County in the state of California within the West region made the most profit for the company. While for all the past years including 2020 Broken Arrow store at Wagoner County in Oklahoma within the Southern region of the country made the most profit."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "1 + 1\n\n[1] 2"
  },
  {
    "objectID": "customer.html",
    "href": "customer.html",
    "title": "3. Transaction Summary Of Customers",
    "section": "",
    "text": "Given that the company sell products to both customers and businesses, let’s get the total number of transaction conducted with each customers.\n\nSELECT customer_names AS Customer, count(customer_names) AS Count\n  FROM customer\n  JOIN sales_order\n    ON customer.customer_id = sales_order.customer_id\n  GROUP BY customer_names\n  ORDER BY Count DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      Customer\n      Count\n    \n  \n  \n    Medline\n210\n    Eminence Corp\n186\n    Elorac, Corp\n181\n    Apotheca, Ltd\n179\n    Apollo Ltd\n178\n    Victory Ltd\n176\n    OUR Ltd\n176\n    Pure Group\n175\n    OHTA'S Corp\n173\n    Fenwal, Corp\n172\n    Ole Group\n171\n    Ei\n171\n    Niconovum Corp\n168\n    ETUDE Ltd\n167\n    Pacific Ltd\n167\n    Qualitest\n165\n    Ohio\n164\n    E. Ltd\n164\n    Sundial\n163\n    Prasco Group\n162\n    Llorens Ltd\n161\n    Weimei Corp\n161\n    Procter Corp\n159\n    S.S.S. Group\n159\n    21st Ltd\n158\n    U.S. Ltd\n157\n    Linde\n157\n    O.E. Ltd\n156\n    Nipro\n156\n    Winthrop\n156\n    Trigen\n156\n    Mylan Corp\n153\n    New Ltd\n153\n    AuroMedics Corp\n152\n    Avon Corp\n152\n    Uriel Group\n152\n    Bare\n152\n    Exact-Rx, Corp\n151\n    Burt's Corp\n151\n    Select\n150\n    Ascend Ltd\n150\n    Amylin Group\n145\n    Dharma Ltd\n145\n    Wuxi Group\n144\n    PEDIFIX, Corp\n143\n    Rochester Ltd\n142\n    Medsep Group\n142\n    Capweld\n140\n    3LAB, Ltd\n135\n    WakeFern\n135\n  \n  \n  \n\n\n\n\n\nFirst the number of customers that have made at least a single order or more over the three year period is 50 and the top 3 customers based on the total unique transactions conducted are Medline, Eminence Corp & Elorac, Corp.\n\n\nNow that we know the total number of unique customers and their overall transaction count, we can now proceed to the total order quantity and sales from each customer.\n\nWITH cus_qos AS (\n      SELECT customer_id,\n             order_quantity,\n             (order_quantity * unit_price) AS sales\n        FROM sales_order\n)\nSELECT customer_names,\n       SUM(order_quantity) AS Total_Order_Quantity,\n       round(SUM(sales), 2) AS Total_Sales\n  FROM cus_qos\n  JOIN customer\n   ON cus_qos.customer_id = customer.customer_id\n  GROUP BY customer_names\n  ORDER BY Total_Sales DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      Customer Names\n      Total Order Quantity\n      Total Sales\n    \n  \n  \n    Medline\n970\n2,248,332\n    Apotheca, Ltd\n828\n2,112,222\n    Pure Group\n783\n1,962,015\n    OUR Ltd\n796\n1,937,828\n    Trigen\n767\n1,895,189\n    Apollo Ltd\n805\n1,883,410\n    Ohio\n778\n1,881,628\n    Ole Group\n765\n1,868,322\n    OHTA'S Corp\n819\n1,856,356\n    Eminence Corp\n785\n1,845,783\n    Elorac, Corp\n880\n1,831,947\n    Ei\n818\n1,830,038\n    Victory Ltd\n812\n1,823,941\n    E. Ltd\n763\n1,793,523\n    ETUDE Ltd\n781\n1,770,582\n    21st Ltd\n706\n1,763,943\n    Prasco Group\n735\n1,762,783\n    Qualitest\n787\n1,723,535\n    Sundial\n720\n1,696,226\n    Fenwal, Corp\n783\n1,670,109\n    Llorens Ltd\n761\n1,653,815\n    S.S.S. Group\n732\n1,640,368\n    Select\n720\n1,636,897\n    Nipro\n669\n1,630,030\n    AuroMedics Corp\n699\n1,622,258\n    O.E. Ltd\n658\n1,620,904\n    Procter Corp\n717\n1,609,233\n    Niconovum Corp\n739\n1,579,626\n    Exact-Rx, Corp\n666\n1,564,276\n    Mylan Corp\n714\n1,561,783\n    Amylin Group\n697\n1,555,070\n    3LAB, Ltd\n630\n1,547,774\n    New Ltd\n723\n1,544,062\n    Weimei Corp\n689\n1,533,047\n    PEDIFIX, Corp\n639\n1,530,756\n    Winthrop\n714\n1,529,992\n    Pacific Ltd\n754\n1,523,888\n    Rochester Ltd\n627\n1,512,726\n    U.S. Ltd\n659\n1,508,083\n    Bare\n653\n1,503,467\n    Capweld\n614\n1,494,033\n    Linde\n681\n1,452,225\n    Uriel Group\n665\n1,450,061\n    Burt's Corp\n649\n1,429,961\n    Ascend Ltd\n640\n1,413,988\n    Medsep Group\n650\n1,411,523\n    Dharma Ltd\n624\n1,408,621\n    Wuxi Group\n652\n1,398,009\n    WakeFern\n611\n1,346,265\n    Avon Corp\n635\n1,322,279\n  \n  \n  \n\n\n\n\n\nIt is no surprise that Medline is the customer with the highest number of order and sales given that they had the highest number of purchase transactions with the company.\n\nA quick dive into Medline and the amount of order and sales for each product.\n\nWITH cus_prod_ors AS (\n      SELECT customer_id,\n             product_id,\n             order_quantity,\n             (order_quantity * unit_price) AS sales\n        FROM sales_order\n)\nSELECT product_name, \n       SUM(order_quantity) AS Total_Order_Quantity,\n       round(SUM(sales), 2) AS Total_Sales\n  FROM cus_prod_ors\n  JOIN customer\n     ON cus_prod_ors.customer_id = customer.customer_id\n  JOIN product\n     ON cus_prod_ors.product_id = product.product_id\n  WHERE customer_names = 'Medline'\n  GROUP BY product_name\n  ORDER BY Total_Sales DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      Product Name\n      Total Order Quantity\n      Total Sales\n    \n  \n  \n    Floral\n48\n144,023.20\n    Accessories\n43\n140,117.10\n    TV and video\n43\n104,392.70\n    Wall Coverings\n28\n101,940.50\n    Bean Bags\n31\n94,590.60\n    Serveware\n26\n92,051.30\n    Floor Lamps\n34\n86,986.10\n    Blankets\n36\n77,820.50\n    Photo Frames\n22\n75,060.10\n    Phones\n28\n67,201.00\n    Wreaths\n26\n66,330.00\n    Platters\n31\n64,775.60\n    Bar Tools\n29\n60,728.80\n    Outdoor Decor\n14\n56,400.60\n    Ornaments\n26\n55,187.90\n    Mirrors\n29\n51,965.20\n    Baseball\n28\n51,040.60\n    Pillows\n14\n50,779.30\n    Bakeware\n18\n49,439.30\n    Cookware\n22\n47,415.90\n    Rugs\n14\n46,290.30\n    Vases\n23\n45,988.80\n    Dinnerware\n26\n44,407.60\n    Vanities\n14\n43,576.80\n    Home Fragrances\n32\n42,779.50\n    Wine Storage\n20\n38,900.20\n    Stemware\n12\n37,071.10\n    Furniture Cushions\n17\n36,890.20\n    Bathroom Furniture\n27\n35,235.30\n    Pendants\n16\n32,836.70\n    Table Lamps\n15\n32,541.90\n    Computers\n14\n31,503.40\n    Wardrobes\n20\n30,371.10\n    Basketball\n16\n29,614.00\n    Wall Frames\n13\n28,381.20\n    Dining Furniture\n13\n27,778.20\n    Festive\n12\n22,780.00\n    Table Linens\n5\n20,240.70\n    Audio\n20\n19,550.60\n    Collectibles\n13\n17,929.20\n    Candleholders\n5\n17,554.00\n    Sculptures\n8\n8,629.60\n    Bedroom Furniture\n7\n5,420.30\n    Cocktail Glasses\n12\n4,984.80\n    Candles\n9\n4,361.70\n    Outdoor Furniture\n3\n2,753.70\n    Clocks\n8\n1,715.20\n  \n  \n  \n\n\n\n\n\nThe most purchased product from Medline is the Floral product with 48 orders and 144,023.2 in sales.\n\n\n\nMoving forward, it is important to know which of the customers are bringing in the highest amount of profit for the business, so let’s get the top 10 customers based on the total amount of profit made from the sales of products.\n\nWITH cus_sp AS (\n      SELECT customer_id,\n             (order_quantity * unit_price) - ((order_quantity * unit_cost) + ((order_quantity * unit_price) * discount_applied)) AS profit\n        FROM sales_order\n)\nSELECT customer_names,\n       round(AVG(profit), 2) AS Average_Profit,\n       round(SUM(profit), 2) AS Total_Profit\n  FROM cus_sp\n  JOIN customer \n    ON cus_sp.customer_id = customer.customer_id\n  GROUP BY customer_names\n  ORDER BY Total_Profit DESC\n  LIMIT 10;\n\n\n\n\n\n\n\n  \n  \n    \n      Customer Names\n      Average Profit\n      Total Profit\n    \n  \n  \n    Medline\n2,936.76\n616,719.24\n    Pure Group\n3,051.59\n534,027.38\n    Apotheca, Ltd\n2,970.79\n531,770.69\n    ETUDE Ltd\n3,155.58\n526,981.06\n    Ei\n2,924.95\n500,166.45\n    Sundial\n3,057.58\n498,384.99\n    OUR Ltd\n2,820.56\n496,418.67\n    Trigen\n3,175.92\n495,444.26\n    Apollo Ltd\n2,739.41\n487,614.23\n    Ohio\n2,923.07\n479,383.08\n  \n  \n  \n\n\n\n\nMedline maintains it position as the top customer with the highest profit made while Trigen had the highest average profit for all periods.\n\n\nAnd lastly on customer exploration, it will be useful to get the highest amount spent on a particular product by a customer.\n\nWITH prod_cus_sale AS (\n      SELECT customer_id,\n             product_id,\n             (order_quantity * unit_price) AS sales\n        FROM sales_order\n)\nSELECT customer_names, \n       product_name,\n       round(SUM(sales), 2) AS Total_Sales\n  FROM prod_cus_sale\n  JOIN customer\n    ON prod_cus_sale.customer_id = customer.customer_id\n  JOIN product\n    ON prod_cus_sale.product_id = product.product_id\n  GROUP BY customer_names, product_name\n  ORDER BY Total_Sales DESC\n  LIMIT 5;\n\n\n\n\n\n\n\n  \n  \n    \n      Customer Names\n      Product Name\n      Total Sales\n    \n  \n  \n    Eminence Corp\nWardrobes\n158,414.80\n    Trigen\nCollectibles\n155,245.70\n    Niconovum Corp\nBathroom Furniture\n144,385.00\n    Medline\nFloral\n144,023.20\n    E. Ltd\nWall Frames\n140,679.90\n  \n  \n  \n\n\n\n\nCustomer Eminence Corp on the Wardrobes product.\n\n\nInsight\n\n\nAll customers have made 630 and above product order within the selected period and the top customer based on number of order, sales and profit is Medline while highest profit made on an average can from Trigen."
  },
  {
    "objectID": "product.html",
    "href": "product.html",
    "title": "2. Product Summary",
    "section": "",
    "text": "First let us get all the unique products sold during the selected period.\n\nSELECT product_name, count(product_name) AS Count\n  FROM product\n  JOIN sales_order\n    ON product.product_id = sales_order.product_id\n  GROUP BY product_name\n  ORDER BY Count DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      Product Name\n      Count\n    \n  \n  \n    Serveware\n200\n    Platters\n200\n    Cocktail Glasses\n195\n    Accessories\n194\n    Wreaths\n190\n    Rugs\n184\n    Wardrobes\n183\n    Ornaments\n182\n    Sculptures\n182\n    Dining Furniture\n181\n    TV and video\n180\n    Collectibles\n179\n    Phones\n178\n    Furniture Cushions\n178\n    Stemware\n177\n    Pendants\n176\n    Bakeware\n175\n    Photo Frames\n173\n    Bathroom Furniture\n173\n    Table Lamps\n172\n    Home Fragrances\n172\n    Baseball\n170\n    Bar Tools\n170\n    Clocks\n170\n    Candleholders\n169\n    Blankets\n168\n    Floral\n168\n    Wine Storage\n168\n    Table Linens\n168\n    Dinnerware\n166\n    Outdoor Decor\n166\n    Festive\n165\n    Vanities\n164\n    Floor Lamps\n164\n    Wall Frames\n163\n    Mirrors\n163\n    Cookware\n162\n    Candles\n158\n    Outdoor Furniture\n157\n    Basketball\n156\n    Wall Coverings\n156\n    Computers\n154\n    Bedroom Furniture\n152\n    Audio\n152\n    Bean Bags\n147\n    Vases\n145\n    Pillows\n126\n  \n  \n  \n\n\n\n\n\nThere are 47 unique products sold from the above table and Serveware & platters have the highest number of unique transactions involved in, while the pillows product have the fewest.\n\n\nFollowing the number of times each product was sold, what are the top 3 products\nbased on the number of order placed for them by customers?\n\nSELECT product_name, SUM(order_quantity) AS Total_Order\n  FROM sales_order\n  JOIN product\n    ON sales_order.product_id = product.product_id\n  GROUP BY product_name\n  ORDER BY Total_Order DESC\n  LIMIT 3;\n\n\n\n\n\n\n\n  \n  \n    \n      Product Name\n      Total Order\n    \n  \n  \n    Accessories\n956\n    Platters\n896\n    Cocktail Glasses\n879\n  \n  \n  \n\n\n\n\n\nThe top 3 product by total number of order for all periods are Accessories, Platters and Cocktail Glasses with 585, 635 and 644 order respectively.\n\n\nWe know the top three must order products, let us get the cost based on\nAverage discount paid for each order to customers.\n\nWITH prod_dis AS (\n    SELECT product_id,\n           (order_quantity * unit_price) * discount_applied AS discount\n      FROM sales_order\n)\nSELECT product_name, round(AVG(discount), 2) AS Average_Discount\n  FROM prod_dis\n  JOIN product\n    ON prod_dis.product_id = product.product_id\n  GROUP BY product_name\n  ORDER BY Average_Discount DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      Product Name\n      Average Discount\n    \n  \n  \n    Mirrors\n1,511.28\n    Basketball\n1,489.14\n    Rugs\n1,428.02\n    Serveware\n1,417.79\n    Collectibles\n1,342.40\n    Bar Tools\n1,333.43\n    Photo Frames\n1,331.88\n    Sculptures\n1,329.62\n    Accessories\n1,327.77\n    Cocktail Glasses\n1,314.29\n    Blankets\n1,309.64\n    Ornaments\n1,302.24\n    Table Linens\n1,290.50\n    Outdoor Furniture\n1,259.69\n    Candles\n1,259.37\n    Vanities\n1,242.55\n    Dining Furniture\n1,224.22\n    Candleholders\n1,219.86\n    TV and video\n1,203.12\n    Wall Frames\n1,195.80\n    Bathroom Furniture\n1,193.01\n    Furniture Cushions\n1,183.27\n    Wine Storage\n1,178.00\n    Table Lamps\n1,168.92\n    Baseball\n1,158.46\n    Dinnerware\n1,151.19\n    Floor Lamps\n1,151.03\n    Clocks\n1,150.46\n    Wall Coverings\n1,145.30\n    Audio\n1,144.74\n    Floral\n1,119.88\n    Platters\n1,113.96\n    Bean Bags\n1,113.67\n    Phones\n1,110.22\n    Pendants\n1,109.18\n    Home Fragrances\n1,093.76\n    Wardrobes\n1,085.89\n    Bedroom Furniture\n1,080.13\n    Festive\n1,076.17\n    Wreaths\n1,069.82\n    Bakeware\n1,052.59\n    Cookware\n1,033.39\n    Vases\n1,014.09\n    Pillows\n1,010.88\n    Outdoor Decor\n998.12\n    Stemware\n993.84\n    Computers\n971.26\n  \n  \n  \n\n\n\n\n\nThe highest average discount was paid for the Mirror product, while the lowest was paid for Computers.\n\n\nProfit summary of all products during:\n\nAll202020192018\n\n\n\nWITH prod_rev AS (\n    SELECT product_id,\n           (order_quantity * unit_price) AS sales,\n           ((order_quantity * unit_cost) + ((order_quantity * unit_price) * discount_applied)) AS cost,\n           (order_quantity * unit_price) - ((order_quantity * unit_cost) + ((order_quantity * unit_price) * discount_applied)) AS profit\n     FROM sales_order\n)\nSELECT product_name, \n       round(SUM(sales), 2) AS Total_Sales,\n       round(SUM(cost), 2) AS Total_Cost,\n       round(SUM(profit), 2) AS Total_Profit\n  FROM prod_rev pv\n  JOIN product p\n    ON pv.product_id = p.product_id\n  GROUP BY product_name\n  ORDER BY Total_Profit DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      Product Name\n      Total Sales\n      Total Cost\n      Total Profit\n    \n  \n  \n    Accessories\n2,358,788.61\n1,707,556.41\n651,232.19\n    Photo Frames\n2,005,638.31\n1,452,454.21\n553,184.09\n    Bathroom Furniture\n2,011,333.31\n1,466,743.10\n544,590.20\n    Cocktail Glasses\n1,976,895.30\n1,437,143.51\n539,751.79\n    Table Linens\n1,981,973.90\n1,457,329.60\n524,644.30\n    Stemware\n1,849,923.60\n1,326,215.96\n523,707.64\n    Collectibles\n2,049,958.80\n1,528,929.09\n521,029.72\n    Platters\n2,052,886.70\n1,532,489.23\n520,397.47\n    Furniture Cushions\n1,925,111.00\n1,419,117.29\n505,993.71\n    Rugs\n2,130,841.20\n1,626,318.04\n504,523.16\n    Ornaments\n1,885,326.39\n1,381,236.43\n504,089.96\n    Serveware\n2,071,546.20\n1,568,826.98\n502,719.22\n    Floral\n1,821,837.20\n1,325,442.68\n496,394.52\n    TV and video\n1,825,415.00\n1,332,367.23\n493,047.76\n    Blankets\n1,870,921.39\n1,378,187.43\n492,733.97\n    Mirrors\n1,921,372.41\n1,429,144.65\n492,227.76\n    Table Lamps\n1,813,589.50\n1,322,768.98\n490,820.52\n    Festive\n1,754,783.61\n1,271,794.57\n482,989.03\n    Dinnerware\n1,727,112.60\n1,249,620.72\n477,491.87\n    Vanities\n1,790,675.50\n1,317,732.19\n472,943.32\n    Wardrobes\n1,868,140.90\n1,395,663.94\n472,476.96\n    Wine Storage\n1,742,422.10\n1,275,602.72\n466,819.38\n    Wall Frames\n1,785,362.40\n1,321,318.13\n464,044.27\n    Wreaths\n1,786,441.10\n1,329,945.18\n456,495.92\n    Bar Tools\n1,821,080.09\n1,365,587.21\n455,492.89\n    Pendants\n1,881,668.20\n1,428,759.83\n452,908.37\n    Dining Furniture\n1,846,178.30\n1,395,752.51\n450,425.78\n    Sculptures\n1,837,501.79\n1,387,507.70\n449,994.10\n    Candles\n1,607,028.49\n1,179,443.98\n427,584.51\n    Home Fragrances\n1,709,974.00\n1,285,435.57\n424,538.43\n    Phones\n1,685,217.50\n1,266,257.12\n418,960.37\n    Baseball\n1,644,092.90\n1,225,832.74\n418,260.16\n    Clocks\n1,703,629.10\n1,288,831.10\n414,798.00\n    Floor Lamps\n1,528,303.49\n1,116,922.87\n411,380.62\n    Outdoor Decor\n1,529,234.79\n1,126,161.76\n403,073.03\n    Basketball\n1,697,592.39\n1,301,471.79\n396,120.60\n    Vases\n1,402,685.20\n1,017,257.08\n385,428.11\n    Wall Coverings\n1,536,377.00\n1,151,271.42\n385,105.58\n    Cookware\n1,436,687.70\n1,052,834.55\n383,853.14\n    Bakeware\n1,642,706.00\n1,259,054.72\n383,651.28\n    Audio\n1,542,400.30\n1,160,707.77\n381,692.53\n    Computers\n1,422,322.90\n1,041,765.48\n380,557.41\n    Bedroom Furniture\n1,401,372.00\n1,035,294.02\n366,077.98\n    Outdoor Furniture\n1,620,314.60\n1,260,024.55\n360,290.05\n    Candleholders\n1,584,898.40\n1,228,773.44\n356,124.96\n    Pillows\n1,268,933.11\n932,424.53\n336,508.57\n    Bean Bags\n1,334,231.30\n1,006,079.64\n328,151.66\n  \n  \n  \n\n\n\n\n\nAcross all sales period the highest amount of profit made from a single product is 651,232.19 e.i the Accessories products.\n\n\n\nWITH prod_rev AS (\n    SELECT product_id,\n           year(order_date) AS order_year,\n           (order_quantity * unit_price) AS sales,\n           ((order_quantity * unit_cost) + ((order_quantity * unit_price) * discount_applied)) AS cost,\n           (order_quantity * unit_price) - ((order_quantity * unit_cost) + ((order_quantity * unit_price) * discount_applied)) AS profit\n      FROM sales_order\n)\nSELECT product_name, \n       round(SUM(sales), 2) AS Total_Sales,\n       round(SUM(cost), 2) AS Total_Cost,\n       round(SUM(profit), 2) AS Total_Profit\n  FROM prod_rev pv\n  JOIN product p\n    ON pv.product_id = p.product_id\n  WHERE order_year = 2020\n  GROUP BY product_name\n  ORDER BY Total_Profit DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      Product Name\n      Total Sales\n      Total Cost\n      Total Profit\n    \n  \n  \n    Wall Frames\n916,312.09\n652,669.15\n263,642.95\n    Furniture Cushions\n833,727.90\n587,628.63\n246,099.27\n    Collectibles\n986,642.00\n741,352.06\n245,289.95\n    Serveware\n957,128.50\n716,216.80\n240,911.70\n    Festive\n848,280.31\n627,086.37\n221,193.94\n    Floral\n738,306.50\n517,185.77\n221,120.74\n    Accessories\n859,261.61\n639,682.37\n219,579.24\n    Dinnerware\n776,081.10\n559,657.50\n216,423.59\n    Bathroom Furniture\n807,443.80\n599,268.91\n208,174.89\n    Wreaths\n810,693.30\n603,893.78\n206,799.52\n    Vanities\n743,700.00\n539,511.54\n204,188.46\n    Table Linens\n744,644.70\n542,231.50\n202,413.19\n    Vases\n719,030.60\n521,997.07\n197,033.53\n    TV and video\n687,560.70\n496,048.10\n191,512.60\n    Cocktail Glasses\n693,898.90\n505,063.79\n188,835.11\n    Wine Storage\n720,779.30\n536,897.73\n183,881.56\n    Photo Frames\n699,553.70\n516,005.86\n183,547.84\n    Basketball\n713,014.00\n532,402.07\n180,611.93\n    Bean Bags\n694,327.70\n514,755.81\n179,571.89\n    Bar Tools\n748,115.30\n568,793.65\n179,321.64\n    Mirrors\n740,618.00\n563,200.83\n177,417.17\n    Rugs\n750,574.20\n577,366.17\n173,208.03\n    Platters\n665,417.20\n493,979.48\n171,437.72\n    Stemware\n620,172.10\n450,011.30\n170,160.80\n    Computers\n625,163.60\n456,713.27\n168,450.32\n    Bakeware\n674,200.90\n508,095.17\n166,105.73\n    Outdoor Decor\n553,674.60\n390,312.69\n163,361.91\n    Candles\n586,203.09\n423,082.05\n163,121.04\n    Bedroom Furniture\n604,648.20\n444,052.22\n160,595.98\n    Table Lamps\n567,905.40\n407,477.79\n160,427.61\n    Dining Furniture\n703,446.40\n546,054.02\n157,392.38\n    Blankets\n638,128.10\n482,461.11\n155,666.99\n    Cookware\n479,639.60\n324,304.36\n155,335.24\n    Phones\n620,533.90\n469,036.48\n151,497.41\n    Pendants\n683,748.40\n532,515.00\n151,233.40\n    Wardrobes\n684,840.50\n535,663.03\n149,177.48\n    Home Fragrances\n595,335.20\n447,076.46\n148,258.74\n    Wall Coverings\n592,909.80\n447,307.65\n145,602.15\n    Sculptures\n584,682.20\n443,362.12\n141,320.08\n    Baseball\n593,559.70\n452,422.93\n141,136.77\n    Outdoor Furniture\n672,572.80\n536,338.96\n136,233.84\n    Floor Lamps\n551,946.00\n418,936.97\n133,009.03\n    Clocks\n524,469.30\n397,002.00\n127,467.30\n    Ornaments\n484,738.30\n362,916.15\n121,822.15\n    Audio\n505,769.60\n388,417.83\n117,351.77\n    Candleholders\n495,491.80\n387,672.19\n107,819.61\n    Pillows\n365,552.00\n262,819.90\n102,732.11\n  \n  \n  \n\n\n\n\n\nIn 2020, more profit was made on the Wall Frames product than other products including Accessories.\n\n\n\nWITH prod_rev AS (\n    SELECT product_id,\n           year(order_date) AS order_year,\n           (order_quantity * unit_price) AS sales,\n           ((order_quantity * unit_cost) + ((order_quantity * unit_price) * discount_applied)) AS cost,\n           (order_quantity * unit_price) - ((order_quantity * unit_cost) + ((order_quantity * unit_price) * discount_applied)) AS profit\n      FROM sales_order\n)\nSELECT product_name, \n       round(SUM(sales), 2) AS Total_Sales,\n       round(SUM(cost), 2) AS Total_Cost,\n       round(SUM(profit), 2) AS Total_Profit\n  FROM prod_rev pv\n  JOIN product p\n    ON pv.product_id = p.product_id\n  WHERE order_year = 2019\n  GROUP BY product_name\n  ORDER BY Total_Profit DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      Product Name\n      Total Sales\n      Total Cost\n      Total Profit\n    \n  \n  \n    Wardrobes\n883,602.70\n637,043.67\n246,559.02\n    Stemware\n850,102.70\n606,337.88\n243,764.83\n    Bathroom Furniture\n824,274.20\n585,916.95\n238,357.26\n    Blankets\n803,584.60\n581,704.19\n221,880.41\n    Ornaments\n731,097.29\n513,270.65\n217,826.64\n    Photo Frames\n810,251.10\n596,597.95\n213,653.15\n    Rugs\n910,925.30\n699,286.47\n211,638.83\n    Vanities\n739,103.80\n532,101.71\n207,002.10\n    Accessories\n774,258.70\n571,290.68\n202,968.02\n    Cocktail Glasses\n704,190.10\n501,523.34\n202,666.75\n    Table Lamps\n812,160.60\n610,783.29\n201,377.31\n    Phones\n774,339.10\n573,754.57\n200,584.53\n    Floor Lamps\n720,095.89\n519,894.64\n200,201.25\n    Mirrors\n769,823.30\n570,849.25\n198,974.05\n    Pendants\n768,804.90\n578,592.94\n190,211.96\n    Platters\n795,437.40\n606,022.34\n189,415.06\n    Collectibles\n672,686.70\n484,785.87\n187,900.83\n    Dinnerware\n653,069.10\n465,210.35\n187,858.75\n    Table Linens\n714,501.40\n527,203.57\n187,297.83\n    Furniture Cushions\n718,286.90\n534,673.40\n183,613.50\n    Wine Storage\n697,094.80\n513,840.02\n183,254.78\n    TV and video\n688,833.70\n511,551.17\n177,282.53\n    Baseball\n659,320.20\n483,682.32\n175,637.89\n    Candles\n629,270.70\n455,856.48\n173,414.22\n    Floral\n715,017.30\n542,483.93\n172,533.37\n    Dining Furniture\n631,213.70\n459,832.83\n171,380.87\n    Serveware\n797,635.00\n628,027.25\n169,607.75\n    Computers\n628,299.20\n460,868.45\n167,430.75\n    Clocks\n664,653.40\n497,816.70\n166,836.70\n    Candleholders\n739,820.70\n575,704.27\n164,116.43\n    Wreaths\n593,894.70\n431,177.97\n162,716.73\n    Home Fragrances\n629,056.30\n473,323.51\n155,732.79\n    Audio\n650,657.10\n495,531.90\n155,125.20\n    Sculptures\n596,949.90\n443,889.61\n153,060.29\n    Bar Tools\n547,738.40\n396,093.78\n151,644.62\n    Festive\n518,861.40\n368,236.52\n150,624.88\n    Outdoor Decor\n510,084.40\n359,548.13\n150,536.27\n    Basketball\n632,761.40\n490,395.75\n142,365.65\n    Pillows\n544,053.40\n403,033.11\n141,020.29\n    Wall Frames\n548,917.60\n414,858.47\n134,059.13\n    Bedroom Furniture\n500,469.90\n366,597.77\n133,872.13\n    Outdoor Furniture\n577,446.20\n445,727.55\n131,718.65\n    Cookware\n554,780.10\n428,819.57\n125,960.53\n    Bakeware\n580,367.40\n454,439.56\n125,927.84\n    Wall Coverings\n495,860.30\n378,937.06\n116,923.24\n    Bean Bags\n432,491.70\n328,855.70\n103,636.00\n    Vases\n338,644.80\n248,240.06\n90,404.74\n  \n  \n  \n\n\n\n\n\n\n\nWITH prod_rev AS (\n    SELECT product_id,\n           year(order_date) AS order_year,\n           (order_quantity * unit_price) AS sales,\n           ((order_quantity * unit_cost) + ((order_quantity * unit_price) * discount_applied)) AS cost,\n           (order_quantity * unit_price) - ((order_quantity * unit_cost) + ((order_quantity * unit_price) * discount_applied)) AS profit\n      FROM sales_order\n)\nSELECT product_name, \n       round(SUM(sales), 2) AS Total_Sales,\n       round(SUM(cost), 2) AS Total_Cost,\n       round(SUM(profit), 2) AS Total_Profit\n  FROM prod_rev pv\n  JOIN product p\n    ON pv.product_id = p.product_id\n  WHERE order_year = 2018\n  GROUP BY product_name\n  ORDER BY Total_Profit DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      Product Name\n      Total Sales\n      Total Cost\n      Total Profit\n    \n  \n  \n    Accessories\n725,268.30\n496,583.37\n228,684.93\n    Ornaments\n669,490.80\n505,049.62\n164,441.18\n    Platters\n592,032.10\n432,487.41\n159,544.68\n    Photo Frames\n495,833.51\n339,850.40\n155,983.11\n    Sculptures\n655,869.70\n500,255.97\n155,613.73\n    Cocktail Glasses\n578,806.30\n430,556.37\n148,249.93\n    Table Linens\n522,827.80\n387,894.53\n134,933.28\n    Table Lamps\n433,523.50\n304,507.90\n129,015.60\n    Bar Tools\n525,226.40\n400,699.77\n124,526.63\n    TV and video\n449,020.60\n324,767.96\n124,252.64\n    Wall Coverings\n447,606.90\n325,026.72\n122,580.18\n    Dining Furniture\n511,518.20\n389,865.66\n121,652.54\n    Home Fragrances\n485,582.50\n365,035.60\n120,546.90\n    Clocks\n514,506.40\n394,012.40\n120,494.01\n    Rugs\n469,341.70\n349,665.40\n119,676.30\n    Mirrors\n410,931.10\n295,094.57\n115,836.54\n    Blankets\n429,208.70\n314,022.13\n115,186.57\n    Pendants\n429,114.90\n317,651.89\n111,463.01\n    Festive\n387,641.90\n276,471.68\n111,170.22\n    Stemware\n379,648.80\n269,866.79\n109,782.01\n    Audio\n385,973.60\n276,758.04\n109,215.56\n    Floral\n368,513.40\n265,772.99\n102,740.41\n    Cookware\n402,268.00\n299,710.63\n102,557.36\n    Baseball\n391,213.00\n289,727.50\n101,485.50\n    Wine Storage\n324,548.00\n224,864.97\n99,683.04\n    Bathroom Furniture\n379,615.30\n281,557.25\n98,058.05\n    Vases\n345,009.80\n247,019.96\n97,989.84\n    Pillows\n359,327.70\n266,571.53\n92,756.17\n    Outdoor Furniture\n370,295.60\n277,958.04\n92,337.56\n    Serveware\n316,782.70\n224,582.93\n92,199.77\n    Bakeware\n388,137.70\n296,519.99\n91,617.71\n    Candles\n391,554.70\n300,505.45\n91,049.24\n    Outdoor Decor\n465,475.80\n376,300.95\n89,174.85\n    Collectibles\n390,630.10\n302,791.16\n87,838.94\n    Wreaths\n381,853.10\n294,873.43\n86,979.67\n    Candleholders\n349,585.90\n265,396.98\n84,188.92\n    Floor Lamps\n256,261.60\n178,091.26\n78,170.34\n    Wardrobes\n299,697.70\n222,957.24\n76,740.46\n    Furniture Cushions\n373,096.20\n296,815.26\n76,280.94\n    Dinnerware\n297,962.40\n224,752.87\n73,209.53\n    Basketball\n351,817.00\n278,673.97\n73,143.03\n    Bedroom Furniture\n296,253.90\n224,644.03\n71,609.87\n    Phones\n290,344.50\n223,466.07\n66,878.43\n    Wall Frames\n320,132.70\n253,790.51\n66,342.20\n    Vanities\n307,871.70\n246,118.94\n61,752.76\n    Bean Bags\n207,411.90\n162,468.13\n44,943.76\n    Computers\n168,860.10\n124,183.76\n44,676.34\n  \n  \n  \n\n\n\n\n\n\n\n\n\nInsight\n\n\nA total of 47 different products was sold over the selected period of which the Accessories products have the highest total number of order, on the cost side an average of 1,511.28 was paid for the Mirror product which was the highest overall. Again the Accessories products was the most profitable product overall for all selected years and also in 2020."
  },
  {
    "objectID": "sales_channel.html",
    "href": "sales_channel.html",
    "title": "4. Method Of Product Sales",
    "section": "",
    "text": "Starting with the unique sales channels and the number of transactions done through them.\n\nSELECT sales_channel, count(sales_channel) AS Count\n  FROM sales_order\n  GROUP BY sales_channel\n  ORDER BY Count DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      Sales Channel\n      Count\n    \n  \n  \n    In-Store\n3,298\n    Online\n2,425\n    Distributor\n1,375\n    Wholesale\n893\n  \n  \n  \n\n\n\n\nMost sales can in through the physical store, followed by online platforms and distributors, while the wholesale channel brought in the lowest number of transactions.\n\n\nThe total & average order quantity and sale from each sales channel.\n\nWITH sc_qos AS (\n    SELECT sales_channel,\n           order_quantity, \n           (order_quantity * unit_price) AS sales\n      FROM sales_order\n)\nSELECT sales_channel,\n       round(AVG(order_quantity), 2) AS Average_Order,\n       SUM(order_quantity) AS Total_order,\n       round(AVG(sales), 2) AS Average_Sales,\n       round(SUM(sales), 2) AS Total_Sales\n  FROM sc_qos\n  GROUP BY sales_channel\n  ORDER BY Total_Sales DESC;\n\n\n\nWarning in result_create(conn@ptr, statement, is_statement): Cancelling previous\nquery\n\n\n\n\n\n\n  \n  \n    \n      Sales Channel\n      Average Order\n      Total Order\n      Average Sales\n      Total Sales\n    \n  \n  \n    In-Store\n4.51\n14,878\n10,321.44\n34,040,114\n    Online\n4.49\n10,897\n10,156.60\n24,629,756\n    Distributor\n4.57\n6,287\n10,770.84\n14,809,908\n    Wholesale\n4.59\n4,100\n10,316.85\n9,212,949\n  \n  \n  \n\n\n\n\n\nInsight\n\n\nGiven the rank of the number of transactions from each sales channel, the same can also be said for the total amount of order and sales, with the exception of the average sales of which the distributor channel had the highest while the online channel had the lowest."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "1. Exploring Business Sales Period",
    "section": "",
    "text": "Before we dive into exploring sales for the selected period, it is important to note that the sales database contains five table of fictitious records which will be used to demonstrate how exploration of a business historical sales records can be performed using MySQL DBMS. The analysis will involve looking into various key performance of selected entities based on several factors such as sales, cost, profit, etc.\n\n\nThe distinct Sales period.\n\nSELECT DISTINCT year(order_date) AS Distinct_Year,   \n       COUNT(order_date) AS Number_Of_Transactions\n  FROM sales_order\n  GROUP BY Distinct_Year;\n\n\n\n\n\n\n\n  \n  \n    \n      Distinct Year\n      Number Of Transactions\n    \n  \n  \n    2018\n1,836\n    2019\n3,030\n    2020\n3,125\n  \n  \n  \n\n\n\n\nThe selected sales record started from the year 2018 and ended in 2020 also there were more orders in 2020 than previous years.\n\n\nGiven the different number of product quantity order in each year, do all the sales years contain the full twelve 12 months.\n\nSELECT tbl.order_year, \n       COUNT(tbl.order_month) AS number_of_distinct_month\n  FROM(SELECT order_date, \n              year(order_date) AS order_year,  \n              month(order_date) AS order_month\n            FROM sales_order\n            GROUP BY order_year, order_month\n            LIMIT 50) AS tbl\n  GROUP BY tbl.order_year;\n\n\n\n\n\n\n\n  \n  \n    \n      Order Year\n      Number Of Distinct Month\n    \n  \n  \n    2018\n8\n    2019\n12\n    2020\n12\n  \n  \n  \n\n\n\n\nApart from the year 2018 which only sales order records for 8 different months all other year have a complete 12 months.\n\n\n\nLet’s get the Summary of sales across previous sales years.\n\nWITH sales_year AS (\n      SELECT year(order_date) AS order_year,\n             monthname(order_date) AS order_month,\n             (order_quantity * unit_price) AS sales\n        FROM sales_order\n)\nSELECT order_year, \n       MIN(sales) AS Minimum,\n       round(AVG(sales), 2) AS Average,\n       round(MAX(sales), 2) AS Maximum,\n       round(SUM(sales), 2) AS Total\n  FROM sales_year\n  GROUP BY order_year;\n\n\n\n\n\n\n\n  \n  \n    \n      Order Year\n      Minimum\n      Average\n      Maximum\n      Total\n    \n  \n  \n    2018\n167.5\n10,508.4\n52,313.6\n19,293,494.2\n    2019\n167.5\n10,407.5\n51,831.2\n31,534,789.5\n    2020\n167.5\n10,196.6\n52,206.4\n31,864,442.9\n  \n  \n  \n\n\n\n\nMore sales was made in 2020 than the previous 2 years given the total amount, but on an average the year 2018 had the highest amount followed by the preceding years.\n\n\nHow much profit was made in previous sales years?\n\nCREATE TEMPORARY TABLE rev_date_tbl\n  SELECT order_date,\n         year(order_date) AS order_year,\n         monthname(order_date) AS order_month,\n         order_quantity,\n         unit_price,\n         (order_quantity * unit_price) AS sales,\n         ((order_quantity * unit_cost) + ((order_quantity * unit_price) * discount_applied)) AS cost,\n         (order_quantity * unit_price) - ((order_quantity * unit_cost) + ((order_quantity * unit_price) * discount_applied)) AS profit\n    FROM sales_order;\n\n\n\n\n\nSELECT order_year, \n       round(AVG(profit), 2) AS Average_Profit, \n       round(SUM(profit), 2) AS Total_Proft \n  FROM rev_date_tbl\n  GROUP BY order_year;\n\n\n\n\n\n\n\n  \n  \n    \n      Order Year\n      Average Profit\n      Total Proft\n    \n  \n  \n    2018\n2,694.58\n4,947,254.21\n    2019\n2,699.86\n8,180,576.37\n    2020\n2,623.20\n8,197,496.32\n  \n  \n  \n\n\n\n\n\nThe total amount of profit made in 2020 was the highest, this was closely followed by the year 2019 while for the average amount of profit the year 2019 had the highest profit followed by 2018 and 2020.\n\n\nGiven the amount made in each of the last sales years, how much was made in each month for all recorded sales years.\n\nSELECT order_month, \n       round(AVG(profit), 2) AS Average_Profit, \n       round(SUM(profit), 2) AS Total_Profit \n  FROM rev_date_tbl\n  GROUP BY order_month;\n\n\n\n\n\n\n\n  \n  \n    \n      Order Month\n      Average Profit\n      Total Profit\n    \n  \n  \n    January\n2,844.14\n1,618,314.79\n    February\n2,661.81\n1,336,229.61\n    March\n2,601.91\n1,168,257.75\n    April\n2,557.10\n1,362,936.06\n    May\n2,737.33\n1,505,532.43\n    June\n2,593.12\n1,918,911.40\n    July\n2,641.59\n2,100,067.46\n    August\n2,693.08\n2,130,230.10\n    September\n2,654.40\n1,977,530.97\n    October\n2,527.68\n1,883,123.41\n    November\n2,826.95\n2,207,849.37\n    December\n2,675.53\n2,116,343.54\n  \n  \n  \n\n\n\n\n\nThe month of November had the highest amount of profit for all three years, while January had the highest average profit. Also March in general had the lowest profit earned in a month.\n\nNow that We know that 2020 has the highest amount of the three years present, let’s get the profit for each month in that year.\n\nSELECT order_month,\n       round(AVG(profit), 2) AS Average_Profit, \n       round(SUM(profit), 2) AS Total_Profit \n  FROM rev_date_tbl\n  WHERE order_year = 2020\n  GROUP BY order_month\n  ORDER BY Total_Profit DESC;\n\n\n\n\n\n\n\n  \n  \n    \n      2020: Order Month\n      Average Profit\n      Total Profit\n    \n  \n  \n    January\n3,048.54\n841,396.27\n    February\n2,726.09\n736,043.11\n    March\n2,512.94\n593,052.71\n    April\n2,497.04\n654,225.51\n    May\n2,879.75\n757,374.55\n    June\n2,621.77\n642,332.91\n    July\n2,893.97\n813,204.32\n    August\n2,568.25\n644,630.10\n    September\n2,387.78\n606,495.82\n    October\n2,215.23\n624,694.52\n    November\n2,468.77\n646,817.43\n    December\n2,622.34\n637,229.08\n  \n  \n  \n\n\n\n\n\nFor the year 2020 the highest amount of profit was made in January while the month with the lowest amount of profit is march, For the average profit made across 2020, The highest amount was also made in January while October had the lowest average amount.\n \n\nInsight\n\n\nThe number of transactions conducted in 2020 and 2019 are almost evenly distributed with the year 2020 having the largest number of transactions, sales and most importantly profit. November is the month with the most profit summed up for all the selected sales period but in 2020 the most profit was made during the first month of the year."
  }
]